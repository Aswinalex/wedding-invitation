<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>You're Invited! - Taniya & Aswin</title>

    <!-- Thumbnail / Social Media Share Tags -->
    <meta property="og:title" content="You're Invited! - Taniya & Aswin's Wedding">
    <meta property="og:description" content="Join us in celebrating the wedding of Taniya and Aswin on January 5th, 2026 in Thiruvalla, Kerala.">
    <meta property="og:image" content="https://raw.githubusercontent.com/Aswinalex/wedding-invitation/main/IMG-20250427-WA0089.jpg">
    <meta property="og:url" content="https://aswinalex.github.io/wedding-invitation/">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Great+Vibes&display=swap" rel="stylesheet">
    <!-- Tone.js for Audio -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <style>
        /* Custom styles for the wedding invite */
        body {
            font-family: 'Cormorant Garamond', serif; /* New elegant font */
            background-color: #fdfaf6;
            color: #5a5a5a; /* Softer text color */
            line-height: 1.7;
            overflow-x: hidden; /* Prevent horizontal scrollbar from animations */
        }
        .font-great-vibes {
            font-family: 'Great Vibes', cursive;
        }
        .hero-section {
            background-image: url('https://raw.githubusercontent.com/Aswinalex/wedding-invitation/main/IMG-20250427-WA0089.jpg');
            background-size: 110%; /* Start slightly zoomed in for Ken Burns */
            background-position: center;
            background-repeat: no-repeat;
            background-color: #d9c0b2;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
            background-attachment: fixed; /* Parallax effect */
            animation: kenburns 20s ease-out infinite; /* Ken Burns effect */
        }
        @keyframes kenburns {
            0% { background-size: 110%; background-position: center center; }
            50% { background-size: 120%; background-position: center top; }
            100% { background-size: 110%; background-position: center center; }
        }
        .hero-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            /* Golden hour gradient */
            background: linear-gradient(to top, rgba(80, 48, 32, 0.4), rgba(242, 188, 133, 0.2));
            z-index: 1;
        }
        .hero-content {
            position: relative;
            z-index: 2;
            background-color: rgba(0,0,0,0.2);
            padding: 2rem;
            border-radius: 0.75rem;
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255,255,255,0.1);
            max-width: 48rem;
            margin: auto;
        }
        .section-divider {
            border-top: 1px solid #d3c7b8;
            width: 80px;
            margin: 2rem auto;
        }
        .btn-primary {
            background-color: #a87b6e;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .btn-primary:hover {
            background-color: #8c655b;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #a87b6e;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-left: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .event-box {
            position: relative;
            overflow: hidden;
            color: white;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
        }
        .event-box-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.2));
            z-index: 1;
            transition: background-color 0.3s ease;
        }
        .event-box:hover .event-box-overlay {
            background-color: rgba(0, 0, 0, 0.4);
        }
        .event-box-content {
            position: relative;
            z-index: 2;
        }
        #guestbookDisplay {
            background-color: #fff;
            border: 1px solid #d3c7b8;
            border-radius: 0.5rem;
            padding: 1.5rem;
            text-align: left;
            min-height: 150px;
        }
        #guestbookDisplay .message {
            border-bottom: 1px solid #eee;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }
        #guestbookDisplay .message:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        /* For scroll animations */
        .fade-in-section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* Timeline Styles */
        .timeline-container { position: relative; padding: 2rem 0; }
        .timeline-container::before { content: ''; position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 2px; height: 100%; background-color: #d3c7b8; }
        .timeline-item { position: relative; width: 50%; padding: 1rem 2rem; box-sizing: border-box; }
        .timeline-item:nth-child(odd) { left: 0; padding-right: 4rem; text-align: right; }
        .timeline-item:nth-child(even) { left: 50%; padding: 1rem 4rem; text-align: left; }
        .timeline-dot { position: absolute; top: 1.5rem; width: 16px; height: 16px; background-color: #a87b6e; border: 2px solid #fdfaf6; border-radius: 50%; z-index: 1; }
        .timeline-item:nth-child(odd) .timeline-dot { right: -8px; }
        .timeline-item:nth-child(even) .timeline-dot { left: -8px; }
        .timeline-content { background-color: #fff; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: 1px solid #d3c7b8; transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .timeline-content:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .timeline-content img { border-radius: 0.5rem; margin-bottom: 1rem; transition: transform 0.3s ease; }
        .timeline-content:hover img { transform: scale(1.05); }

        /* Mobile-specific styles for the timeline */
        @media (max-width: 767px) {
            .timeline-container::before {
                left: 8px;
                transform: translateX(0);
            }
            .timeline-item {
                width: 100%;
                padding-left: 2.5rem;
                padding-right: 1rem;
            }
            .timeline-item:nth-child(odd),
            .timeline-item:nth-child(even) {
                left: 0;
                text-align: left;
            }
            .timeline-item:nth-child(odd) .timeline-dot,
            .timeline-item:nth-child(even) .timeline-dot {
                left: 0;
            }
        }

        /* --- NEW ANIMATIONS --- */
        /* Menu reveal animation */
        .menu-list li {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }

        /* Menu heading hover animation */
        .menu-section h2 {
            cursor: pointer;
        }
        .menu-section h3 {
            transition: transform 0.3s ease, color 0.3s ease;
        }
        .menu-section h3:hover {
            transform: scale(1.05);
            color: #8c655b; /* Darker shade */
        }

        /* Perfect Equation Animation */
        .equation-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }
        @media (min-width: 768px) {
            .equation-container {
                flex-direction: row;
                gap: 2rem;
            }
        }

        .person-container {
            transition: transform 1.2s cubic-bezier(0.25, 1, 0.5, 1);
        }
        .person-container.taniya { transform: translateX(-100vw); }
        .person-container.aswin { transform: translateX(100vw); }

        .plus-sign {
            opacity: 0;
            transform: scale(0);
            transition: opacity 0.5s 1s ease, transform 0.5s 1s cubic-bezier(0.34, 1.56, 0.64, 1); /* Delay and bounce effect */
        }

        .equation-section.is-visible .person-container.taniya {
            transform: translateX(0);
        }
        .equation-section.is-visible .person-container.aswin {
            transform: translateX(0);
        }

        .equation-section.is-visible .equation-container {
            animation: pulse 2s 1.5s ease-in-out infinite; /* Delayed pulse animation */
        }
    </style>
</head>
<body class="antialiased">
    
    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 bg-black bg-opacity-50">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm text-center">
            <h3 class="text-lg font-semibold mb-4">Are you sure?</h3>
            <p class="text-gray-600 mb-6">Do you really want to delete this message? This action cannot be undone.</p>
            <div class="flex justify-center gap-4">
                <button id="cancelDelete" class="px-6 py-2 rounded-full text-gray-700 bg-gray-200 hover:bg-gray-300">Cancel</button>
                <button id="confirmDelete" class="px-6 py-2 rounded-full text-white bg-red-600 hover:bg-red-700">Delete</button>
            </div>
        </div>
    </div>

    <!-- Hero Section -->
    <header id="heroSection" class="hero-section text-center p-4">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h4 class="text-xl md:text-2xl mb-4 font-cormorant-garamond italic">Together with their families</h4>
            <h1 class="text-6xl md:text-8xl font-great-vibes mb-6">Taniya & Aswin</h1>
            <p class="text-xl md:text-2xl mb-2">Daughter of Binny & Laly Mathew</p>
            <p class="text-xl md:text-2xl mb-8">Son of Dr. Salim C Eapen & Renu Thomas</p>
        </div>
    </header>

    <!-- Countdown Timer Section -->
    <section class="bg-[#a87b6e] text-white py-8 px-4 text-center">
        <h2 class="text-3xl md:text-4xl font-great-vibes mb-4">Counting down to the big day!</h2>
        <div id="countdown" class="grid grid-cols-4 gap-4 max-w-md mx-auto text-center">
            <div><div id="days" class="text-4xl md:text-6xl font-semibold">00</div><div class="text-sm uppercase tracking-wider">Days</div></div>
            <div><div id="hours" class="text-4xl md:text-6xl font-semibold">00</div><div class="text-sm uppercase tracking-wider">Hours</div></div>
            <div><div id="minutes" class="text-4xl md:text-6xl font-semibold">00</div><div class="text-sm uppercase tracking-wider">Minutes</div></div>
            <div><div id="seconds" class="text-4xl md:text-6xl font-semibold">00</div><div class="text-sm uppercase tracking-wider">Seconds</div></div>
        </div>
    </section>

    <!-- Bible Verse Section -->
    <section class="py-16 px-4 text-center fade-in-section">
        <div class="max-w-3xl mx-auto">
            <p class="text-2xl italic text-gray-700">"So they are no longer two, but one flesh. Therefore what God has joined together, let no one separate."</p>
            <p class="text-lg mt-2 text-gray-500">- Matthew 19:6</p>
            <div class="section-divider"></div>
            <p class="text-2xl italic text-gray-700">"‡¥Ö‡¥§‡µÅ‡¥ï‡µä‡¥£‡µç‡¥ü‡µç ‡¥Ö‡¥µ‡µº ‡¥Æ‡µá‡¥≤‡¥æ‡µΩ ‡¥∞‡¥£‡µç‡¥ü‡¥≤‡µç‡¥≤, ‡¥í‡¥∞‡µÅ ‡¥ú‡¥°‡¥Æ‡¥§‡µç‡¥∞‡µá. ‡¥Ü‡¥ï‡¥Ø‡¥æ‡µΩ ‡¥¶‡µà‡¥µ‡¥Ç ‡¥Ø‡µã‡¥ú‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ö‡µç‡¥ö‡¥§‡¥ø‡¥®‡µÜ ‡¥Æ‡¥®‡µÅ‡¥∑‡µç‡¥Ø‡µª ‡¥µ‡µá‡µº‡¥™‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡¥∞‡µÅ‡¥§‡µç."</p>
            <p class="text-lg mt-2 text-gray-500">- ‡¥Æ‡¥§‡µç‡¥§‡¥æ‡¥Ø‡¥ø 19:6</p>
        </div>
    </section>

    <!-- Details Section -->
    <section class="bg-[#f2ede8] py-16 px-4 text-center fade-in-section">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-5xl font-great-vibes mb-4 text-[#a87b6e]">The Ceremony & Reception</h2>
            <div class="section-divider"></div>
            <p class="text-xl mb-8">From a journey that began in Kerala and led to PhDs in Germany and Singapore, we are overjoyed to return home to celebrate the next chapter of our lives with the people we love most.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 text-left">
                <div class="event-box p-8 rounded-xl shadow-lg" style="background-image: url('https://raw.githubusercontent.com/Aswinalex/wedding-invitation/main/church.jpg'); background-size: cover; background-position: center;"><div class="event-box-overlay rounded-xl"></div><div class="event-box-content"><h3 class="text-3xl font-great-vibes mb-4">Wedding Ceremony</h3><p class="mb-2"><strong class="font-semibold">Date:</strong> January 5th, 2026</p><p class="mb-2"><strong class="font-semibold">Time:</strong> 3:00 PM</p><p class="mb-2"><strong class="font-semibold">Venue:</strong> St Thomas Mar Thoma Church</p><p class="mb-2"><strong class="font-semibold">Address:</strong> Thiruvalla, Pathanamthitta, Kerala ‚Äì 689101</p><p class="text-sm text-gray-200 mt-4">Please arrive 15-30 minutes prior to the ceremony start time.</p></div></div>
                <div class="event-box p-8 rounded-xl shadow-lg" style="background-image: url('https://raw.githubusercontent.com/Aswinalex/wedding-invitation/main/hall.jpg'); background-size: cover; background-position: center;"><div class="event-box-overlay rounded-xl"></div><div class="event-box-content"><h3 class="text-3xl font-great-vibes mb-4">Reception</h3><p class="mb-2"><strong class="font-semibold">Time:</strong> 5:30 PM ‚Äì 10:00 PM</p><p class="mb-2"><strong class="font-semibold">Venue:</strong> Mor Athanasius Yohan Memorial Convention Centre</p><p class="mb-2"><strong class="font-semibold">Address:</strong> Kuttappuzha, Thiruvalla, Pathanamthitta, Kerala ‚Äì 689103</p><p class="text-sm text-gray-200 mt-4">Dinner, dancing, and celebrations will continue into the evening.</p></div></div>
            </div>
        </div>
    </section>
    
    <!-- Menu Section -->
    <section class="py-16 px-4 text-center fade-in-section menu-section">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-5xl font-great-vibes mb-4 text-[#a87b6e]">The Wedding Feast</h2>
            <div class="section-divider"></div>
            <p class="text-xl mb-8">A taste of Kerala to celebrate our special day. We hope you enjoy the feast!</p>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 text-left text-lg">
                <!-- Welcome Drinks & Starters -->
                <div class="space-y-6">
                    <div>
                        <h3 class="text-3xl font-great-vibes mb-2 text-[#a87b6e]">Welcome Drink</h3>
                        <ul class="space-y-1 text-gray-700 menu-list">
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Ginger lime</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Watermelon juice</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Passion fruit honey fizz</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-3xl font-great-vibes mb-2 text-[#a87b6e]">Starter</h3>
                        <ul class="space-y-1 text-gray-700 menu-list">
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Veg spring rolls</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Cocktail beef samosa</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Chicken skewers</li>
                        </ul>
                    </div>
                     <div>
                        <h3 class="text-3xl font-great-vibes mb-2 text-[#a87b6e]">Soups</h3>
                        <ul class="space-y-1 text-gray-700 menu-list">
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Cream of chicken</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Sweet corn veg</li>
                        </ul>
                    </div>
                </div>
                <!-- Main Course -->
                <div>
                    <h3 class="text-3xl font-great-vibes mb-2 text-[#a87b6e]">Main Course</h3>
                    <ul class="space-y-1 text-gray-700 menu-list">
                        <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Nool porotta</li>
                        <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Ari pathiri</li>
                        <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Beef olarthiyathu</li>
                        <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Fish mango curry</li>
                        <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Green pea stew</li>
                        <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Pulav</li>
                        <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Butter chicken</li>
                        <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Paneer butter masala</li>
                    </ul>
                </div>
                <!-- Thattukada & Dessert -->
                <div class="space-y-6">
                    <div>
                        <h3 class="text-3xl font-great-vibes mb-2 text-[#a87b6e]">Thattukada</h3>
                        <ul class="space-y-1 text-gray-700 menu-list">
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Variety of dosa (4 options)</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Kappa & Fish curry</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Chammantis</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Sulaimani (mint tea)</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Lime tea</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-3xl font-great-vibes mb-2 text-[#a87b6e]">Dessert</h3>
                        <ul class="space-y-1 text-gray-700 menu-list">
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Elaneer pudding</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Live jilebi</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Vanilla ice cream</li>
                            <li><span class="text-[#a87b6e] mr-2">&#10042;</span>Tiramisu</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Our Perfect Equation Section -->
    <section class="bg-[#f2ede8] py-16 px-4 text-center fade-in-section equation-section">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-5xl font-great-vibes mb-4 text-[#a87b6e]">Our Perfect Equation</h2>
            <div class="section-divider"></div>
            <p class="text-xl mb-8">From laser optics to evolutionary biology, our worlds collided to create the perfect chemistry.</p>
            <div class="equation-container">
                <div class="person-container taniya text-center">
                    <svg class="w-24 h-24 mx-auto text-[#a87b6e]" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547a2 2 0 00-.547 1.806l.477 2.387a6 6 0 00.517 3.86l.158.318a6 6 0 003.86.517l2.387.477a2 2 0 001.806-.547a2 2 0 00.547-1.806l-.477-2.387a6 6 0 00-.517-3.86l-.158-.318a6 6 0 00-.517-3.86l2.387-.477a2 2 0 001.022-.547z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6a6 6 0 100 12 6 6 0 000-12z"></path></svg>
                    <h3 class="text-3xl font-great-vibes mt-4">Taniya</h3>
                    <p class="font-semibold">Evolutionary Biology</p>
                </div>
                <div class="plus-sign text-4xl font-great-vibes text-[#a87b6e]">+</div>
                <div class="person-container aswin text-center">
                    <svg class="w-24 h-24 mx-auto text-[#a87b6e]" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>
                    <h3 class="text-3xl font-great-vibes mt-4">Aswin</h3>
                    <p class="font-semibold">Laser & Optics</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Map & Directions Section -->
    <section class="py-16 px-4 text-center fade-in-section">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-5xl font-great-vibes mb-4 text-[#a87b6e]">How to Get There</h2>
            <div class="section-divider"></div>
            <p class="text-xl mb-8">We can't wait to see you! Here are the locations for our special day.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <a href="https://www.google.com/maps/search/?api=1&query=St+Thomas+Mar+Thoma+Church,+Thiruvalla,+Pathanamthitta,+Kerala" target="_blank" rel="noopener noreferrer" class="block p-6 bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-2xl transition-shadow duration-300"><h3 class="text-3xl font-great-vibes mb-2 text-[#a87b6e]">Ceremony</h3><p class="font-semibold text-lg">St Thomas Mar Thoma Church</p><p class="text-gray-600">Thiruvalla, Pathanamthitta, Kerala</p><span class="mt-4 inline-block btn-primary">Get Directions</span></a>
                <a href="https://www.google.com/maps/search/?api=1&query=Mor+Athanasius+Yohan+Memorial+Convention+Centre,+Kuttappuzha,+Thiruvalla" target="_blank" rel="noopener noreferrer" class="block p-6 bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-2xl transition-shadow duration-300"><h3 class="text-3xl font-great-vibes mb-2 text-[#a87b6e]">Reception</h3><p class="font-semibold text-lg">Mor Athanasius Yohan Memorial Convention Centre</p><p class="text-gray-600">Kuttappuzha, Thiruvalla, Pathanamthitta</p><span class="mt-4 inline-block btn-primary">Get Directions</span></a>
            </div>
        </div>
    </section>
    
    <!-- Local Favorites Section -->
    <section class="bg-[#f2ede8] py-16 px-4 text-center fade-in-section">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-5xl font-great-vibes mb-4 text-[#a87b6e]">Our Local Favorites</h2>
            <div class="section-divider"></div>
            <p class="text-xl mb-8">If you have some extra time, here are a few of our favorite spots near Thiruvalla!</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-left">
                <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-center">
                    <div class="text-4xl mb-2">‚òï</div>
                    <h3 class="text-2xl font-great-vibes text-[#a87b6e]">Favorite Cafe</h3>
                    <p class="font-semibold">The Daily Grind</p>
                    <p class="text-sm text-gray-600">For the best coffee and pastries to start your day.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-center">
                    <div class="text-4xl mb-2">üèûÔ∏è</div>
                    <h3 class="text-2xl font-great-vibes text-[#a87b6e]">Scenic Walk</h3>
                    <p class="font-semibold">Pamba River Walk</p>
                    <p class="text-sm text-gray-600">A beautiful and peaceful walk along the riverbanks.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-center">
                    <div class="text-4xl mb-2">üçΩÔ∏è</div>
                    <h3 class="text-2xl font-great-vibes text-[#a87b6e]">Must-Try Food</h3>
                    <p class="font-semibold">Avees Puttu House</p>
                    <p class="text-sm text-gray-600">For authentic and delicious Kerala cuisine.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- RSVP Section -->
    <section class="py-16 px-4 text-center fade-in-section">
        <div class="max-w-2xl mx-auto">
            <h2 class="text-5xl font-great-vibes mb-4 text-[#a87b6e]">RSVP</h2>
            <div class="section-divider"></div>
            <p class="text-xl mb-8">Kindly respond by October 1st, 2025 so we can finalize our arrangements.</p>
            <form id="rsvpForm" class="text-left space-y-4">
                <input type="text" name="Name" placeholder="Your Name(s)" required class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#a87b6e] focus:border-transparent text-lg">
                <select name="Attending" required class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#a87b6e] focus:border-transparent text-lg">
                    <option value="" disabled selected>Will you be attending?</option>
                    <option value="Yes, with pleasure!">Yes, with pleasure!</option>
                    <option value="No, with regrets.">No, with regrets.</option>
                </select>
                <input type="number" name="Guests" placeholder="Number of guests" min="0" required class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#a87b6e] focus:border-transparent text-lg">
                <textarea name="Message" placeholder="Optional message (Request a song at wedding)" rows="3" class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#a87b6e] focus:border-transparent text-lg"></textarea>
                <div class="text-center">
                    <button type="submit" id="rsvpSubmitBtn" class="btn-primary inline-flex items-center text-lg font-semibold shadow-md hover:shadow-lg">Submit RSVP<span id="rsvpLoadingSpinner" class="loading-spinner hidden"></span></button>
                </div>
            </form>
            <div id="rsvpMessage" class="mt-4"></div>
        </div>
    </section>

    <!-- Guestbook Section -->
    <section class="py-16 px-4 text-center fade-in-section">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-5xl font-great-vibes mb-4 text-[#a87b6e]">Guestbook</h2>
            <div class="section-divider"></div>
            <p class="text-xl mb-8">Leave a message for the happy couple!</p>
            <form id="guestbookForm" class="text-left space-y-4 mb-8">
                <input type="text" id="guestName" placeholder="Your Name" required class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#a87b6e] focus:border-transparent text-lg">
                <textarea id="guestMessage" placeholder="Your message" required rows="4" class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#a87b6e] focus:border-transparent text-lg"></textarea>
                <div class="text-center">
                    <button type="submit" class="btn-primary inline-flex items-center text-lg font-semibold shadow-md hover:shadow-lg">Post Message<span id="guestbookLoadingSpinner" class="loading-spinner hidden"></span></button>
                </div>
            </form>
            <div id="guestbookDisplay" class="space-y-4"><p class="text-gray-500">Loading messages...</p></div>
        </div>
    </section>

    <!-- AI Dress Code Advisor Section -->
    <section class="bg-[#f2ede8] py-16 px-4 text-center fade-in-section">
        <div class="max-w-2xl mx-auto">
            <h2 class="text-5xl font-great-vibes mb-4 text-[#a87b6e]">AI Dress Code Advisor</h2>
            <div class="section-divider"></div>
            <p class="text-xl mb-8">Have a question about what to wear? Our AI assistant can help! The dress code is formal or festive wear.</p>
            <div class="space-y-4 text-left">
                <input type="text" id="dressCodeQuery" placeholder="e.g., 'Is a floral summer dress okay?'" class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#a87b6e] focus:border-transparent text-lg">
                <div class="text-center">
                    <button id="dressCodeBtn" class="btn-primary inline-flex items-center text-lg font-semibold shadow-md hover:shadow-lg">Ask Assistant<span id="dressCodeSpinner" class="loading-spinner hidden"></span></button>
                </div>
                <div id="dressCodeResponse" class="p-4 bg-white rounded-lg border border-gray-200 min-h-[50px] text-gray-600 text-lg">Your answer will appear here...</div>
            </div>
        </div>
    </section>

    <!-- Wedding Party Section -->
    <section class="py-16 px-4 text-center fade-in-section">
        <div class="max-w-5xl mx-auto">
            <h2 class="text-5xl font-great-vibes mb-4 text-[#a87b6e]">Meet Our Family</h2>
            <div class="section-divider"></div>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-8">
                <div class="text-center"><img src="https://placehold.co/300x300/d3c7b8/4a4a4a?text=Photo" alt="Parents of the Bride" class="w-40 h-40 mx-auto rounded-full shadow-lg object-cover"><h3 class="text-2xl font-great-vibes mt-4">Binny & Laly Mathew</h3><p class="text-gray-600">Parents of the Bride</p></div>
                <div class="text-center"><img src="https://placehold.co/300x300/d3c7b8/4a4a4a?text=Photo" alt="Parents of the Groom" class="w-40 h-40 mx-auto rounded-full shadow-lg object-cover"><h3 class="text-2xl font-great-vibes mt-4">Dr. Salim & Renu Eapen</h3><p class="text-gray-600">Parents of the Groom</p></div>
                <div class="text-center"><img src="https://placehold.co/300x300/d3c7b8/4a4a4a?text=Photo" alt="Brother and Sister-in-Law" class="w-40 h-40 mx-auto rounded-full shadow-lg object-cover"><h3 class="text-2xl font-great-vibes mt-4">Nevil & Bincy</h3><p class="text-gray-600">Brother & Sister-in-Law</p></div>
                <div class="text-center"><img src="https://placehold.co/300x300/d3c7b8/4a4a4a?text=Photo" alt="Sister of the Bride" class="w-40 h-40 mx-auto rounded-full shadow-lg object-cover"><h3 class="text-2xl font-great-vibes mt-4">Nitty</h3><p class="text-gray-600">Sister of the Bride</p></div>
                <div class="text-center"><img src="https://placehold.co/300x300/d3c7b8/4a4a4a?text=Photo" alt="Sister of the Groom" class="w-40 h-40 mx-auto rounded-full shadow-lg object-cover"><h3 class="text-2xl font-great-vibes mt-4">Ida</h3><p class="text-gray-600">Sister of the Groom</p></div>
                <div class="text-center"><img src="https://placehold.co/300x300/d3c7b8/4a4a4a?text=Photo" alt="Nieces" class="w-40 h-40 mx-auto rounded-full shadow-lg object-cover"><h3 class="text-2xl font-great-vibes mt-4">Eva & Ema</h3><p class="text-gray-600">Our beloved nieces</p></div>
            </div>
        </div>
    </section>
    
    <!-- Our Story Timeline Section -->
    <section class="bg-[#f2ede8] py-16 px-4 text-center fade-in-section">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-5xl font-great-vibes mb-4 text-[#a87b6e]">Our Story</h2>
            <div class="section-divider"></div>
            <p class="text-xl mb-8">A few of our favorite moments on the journey to today.</p>
            <div class="timeline-container">
                <!-- Timeline Item 1 -->
                <div class="timeline-item fade-in-section">
                    <div class="timeline-dot"></div>
                    <div class="timeline-content">
                        <img src="https://raw.githubusercontent.com/Aswinalex/wedding-invitation/main/IMG20250425153546.jpg" alt="Taniya and Aswin in front of the Louvre">
                        <h3 class="text-3xl font-great-vibes text-[#a87b6e]">A Parisian Adventure</h3>
                        <p class="text-sm text-gray-500 mb-2">April 2025</p>
                        <p>Exploring the streets of Paris and making memories that will last a lifetime, right in front of the iconic Louvre.</p>
                    </div>
                </div>
                <!-- Timeline Item 2 -->
                <div class="timeline-item fade-in-section">
                    <div class="timeline-dot"></div>
                    <div class="timeline-content">
                        <img src="https://raw.githubusercontent.com/Aswinalex/wedding-invitation/main/IMG-20250427-WA0029.jpg" alt="Taniya and Aswin embracing">
                        <h3 class="text-3xl font-great-vibes text-[#a87b6e]">Mountain Views</h3>
                        <p class="text-sm text-gray-500 mb-2">April 2025</p>
                        <p>Nothing beats a warm hug with a breathtaking view. A perfect day spent together in the beauty of nature.</p>
                    </div>
                </div>
                <!-- Timeline Item 3 -->
                <div class="timeline-item fade-in-section">
                    <div class="timeline-dot"></div>
                    <div class="timeline-content">
                        <img src="https://raw.githubusercontent.com/Aswinalex/wedding-invitation/main/IMG-20250429-WA0030.jpg" alt="Taniya and Aswin by a lake">
                        <h3 class="text-3xl font-great-vibes text-[#a87b6e]">Lakeside Serenity</h3>
                        <p class="text-sm text-gray-500 mb-2">April 2025</p>
                        <p>A quiet, peaceful afternoon by the lake, just enjoying each other's company and the calm surroundings.</p>
                    </div>
                </div>
                <!-- Timeline Item 4 -->
                <div class="timeline-item fade-in-section">
                    <div class="timeline-dot"></div>
                    <div class="timeline-content">
                        <img src="https://raw.githubusercontent.com/Aswinalex/wedding-invitation/main/IMG-20250427-WA0089.jpg" alt="Taniya and Aswin in a field of yellow flowers">
                        <h3 class="text-3xl font-great-vibes text-[#a87b6e]">Golden Hour</h3>
                        <p class="text-sm text-gray-500 mb-2">April 2025</p>
                        <p>Laughter and sunshine in a field of gold. A happy moment that perfectly captures our love.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Photo Gallery Teaser Section -->
    <section class="py-16 px-4 text-center fade-in-section">
        <div class="max-w-2xl mx-auto">
            <h2 class="text-5xl font-great-vibes mb-4 text-[#a87b6e]">Our Wedding Gallery</h2>
            <div class="section-divider"></div>
            <p class="text-xl mb-8">We'll be sharing photos from our special day here. Please check back after January 5th!</p>
            <a href="#" class="btn-primary inline-block text-lg font-semibold shadow-md opacity-50 cursor-not-allowed">
                Coming Soon
            </a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-[#a87b6e] text-white py-8 px-4 text-center rounded-t-xl">
        <div class="max-w-4xl mx-auto">
            <p class="text-2xl mb-2 font-great-vibes">We can't wait to celebrate with you!</p>
            <p class="text-sm mb-2">With love from our families</p>
            <p class="text-sm">&copy; 2026 Taniya & Aswin. All Rights Reserved.</p>
            <div class="mt-4">
                <button id="copyUserIdBtn" class="text-xs text-white/50 hover:text-white">Copy Admin ID: <span id="userIdDisplay"></span></button>
            </div>
        </div>
    </footer>

    <!-- Mute Button -->
    <button id="muteBtn" class="fixed bottom-5 right-5 z-50 bg-white/50 p-3 rounded-full shadow-lg backdrop-blur-sm hover:bg-white/75 transition">
        <!-- Speaker Icon -->
        <svg id="speakerIcon" class="w-6 h-6 text-[#a87b6e]" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg>
        <!-- Muted Icon (hidden by default) -->
        <svg id="mutedIcon" class="w-6 h-6 text-[#a87b6e] hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clip-rule="evenodd"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"></path></svg>
    </button>

    <script type="module">
        // --- Firebase Imports (needed for Guestbook only) ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- Global Firebase instances and user state ---
        let db = null;
        let auth = null;
        let userId = null;
        let isAuthReady = false;

        // --- IMPORTANT: Paste your deployed Google Apps Script Web App URL here ---
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwhgKz9-l3TcUuZ27i5EVk8-dGjJPIkfb3TUjbqsSaVrHF_8n0QwW0jOwMvXQCGj19Flg/exec";

        // --- Main Page Logic ---
        document.addEventListener('DOMContentLoaded', async () => {
            
            // --- Background Music ---
            const muteBtn = document.getElementById('muteBtn');
            const speakerIcon = document.getElementById('speakerIcon');
            const mutedIcon = document.getElementById('mutedIcon');
            let musicStarted = false;

            // Add effects for a richer sound
            const reverb = new Tone.Reverb({ decay: 2, preDelay: 0.01 }).toDestination();
            const chorus = new Tone.Chorus(4, 2.5, 0.5).connect(reverb).start();

            // Create a PolySynth for a piano-like sound
            const synth = new Tone.PolySynth(Tone.Synth, {
                oscillator: {
                    type: "fatsawtooth",
                    count: 3,
                    spread: 30
                },
                envelope: {
                    attack: 0.01,
                    decay: 0.1,
                    sustain: 0.5,
                    release: 0.8,
                    attackCurve: "exponential"
                },
            }).connect(chorus);
            synth.volume.value = -12; // Lower the volume to be more like background music

            // Define the melody of "Amazing Grace"
            const amazingGraceMelody = [
                { time: '0:0', note: 'G3', duration: '4n' }, { time: '0:1', note: 'C4', duration: '4n' },
                { time: '0:2', note: 'E4', duration: '4n' }, { time: '0:3', note: 'C4', duration: '4n' },
                { time: '1:0', note: 'E4', duration: '4n' }, { time: '1:1', note: 'D4', duration: '4n' },
                { time: '1:2', note: 'C4', duration: '2n' }, { time: '2:0', note: 'A3', duration: '4n' },
                { time: '2:1', note: 'G3', duration: '2n' }, { time: '3:0', note: 'G3', duration: '4n' },
                { time: '3:1', note: 'C4', duration: '4n' }, { time: '3:2', note: 'E4', duration: '4n' },
                { time: '3:3', note: 'C4', duration: '4n' }, { time: '4:0', note: 'E4', duration: '4n' },
                { time: '4:1', note: 'D4', duration: '4n' }, { time: '4:2', note: 'G4', duration: '2n' },
            ];

            // Create a part, which is a collection of notes to be played by the synth
            const melodyPart = new Tone.Part((time, value) => {
                synth.triggerAttackRelease(value.note, value.duration, time);
            }, amazingGraceMelody);

            // Configure the melody to loop
            melodyPart.loop = true;
            melodyPart.loopEnd = '5m';
            Tone.Transport.bpm.value = 80;

            // Function to start the music, must be triggered by user interaction
            const startMusic = async () => {
                if (musicStarted) return;
                await Tone.start();
                melodyPart.start(0);
                Tone.Transport.start();
                musicStarted = true;
            };

            // Play music on the first click anywhere on the body
            document.body.addEventListener('click', (e) => {
                const isFormElement = ['INPUT', 'TEXTAREA', 'SELECT', 'BUTTON'].includes(e.target.tagName);
                const isMuteButton = e.target.closest('#muteBtn');
                if (!isFormElement && !isMuteButton) {
                    startMusic();
                }
            }, { once: true }); // Use { once: true } so this only fires for the very first click

            // Mute button logic
            muteBtn.addEventListener('click', (e) => {
                e.stopPropagation(); // Prevent this click from triggering other click listeners
                if (!musicStarted) {
                    startMusic();
                } else {
                    Tone.Destination.mute = !Tone.Destination.mute;
                }
                // Update icon visibility based on mute state
                speakerIcon.classList.toggle('hidden', Tone.Destination.mute);
                mutedIcon.classList.toggle('hidden', !Tone.Destination.mute);
            });


            // --- Countdown Timer ---
            const countdownDate = new Date("January 5, 2026 15:00:00").getTime();
            const countdownInterval = setInterval(() => {
                const now = new Date().getTime();
                const distance = countdownDate - now;
                document.getElementById('days').innerText = Math.floor(distance / (1000 * 60 * 60 * 24)).toString().padStart(2, '0');
                document.getElementById('hours').innerText = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0');
                document.getElementById('minutes').innerText = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
                document.getElementById('seconds').innerText = Math.floor((distance % (1000 * 60)) / 1000).toString().padStart(2, '0');
                if (distance < 0) { clearInterval(countdownInterval); document.getElementById('countdown').innerHTML = "<p class='col-span-4 text-2xl'>The day is here!</p>"; }
            }, 1000);

            // --- Scroll Animations ---
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.fade-in-section').forEach(section => { observer.observe(section); });

            // --- Wedding Feast Click Animation ---
            const weddingFeastTitle = document.querySelector('.menu-section h2');
            weddingFeastTitle.addEventListener('click', () => {
                const menuLists = document.querySelectorAll('.menu-section .menu-list');
                menuLists.forEach(list => {
                    const menuItems = list.querySelectorAll('li');
                    menuItems.forEach((item, index) => {
                        setTimeout(() => {
                            item.style.opacity = '1';
                            item.style.transform = 'translateY(0)';
                        }, index * 100); // Staggered delay
                    });
                });
            }, { once: true }); // This ensures the animation only runs once per click

            // --- Firebase Initialization and Auth ---
            // --- Inject Firebase config and app ID FIRST ---
            window.__firebase_config = JSON.stringify({
            apiKey: "AIzaSyDbZgEemDAd0-g8rCOEgkjflwgQfe2_Sew",
            authDomain: "wedding-aswin-taniya.firebaseapp.com",
            projectId: "wedding-aswin-taniya",
            storageBucket: "wedding-aswin-taniya.firebasestorage.app",
            messagingSenderId: "310162251053",
            appId: "1:310162251053:web:1a24dbf68f0bd4679587a4"
            });
            window.__app_id = "wedding-aswin-taniya";
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
            const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
            try {
    
                const app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);

                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        isAuthReady = true;
                        document.getElementById('userIdDisplay').textContent = userId;
                        // Now that auth is ready, set up the real-time listener for the guestbook
                        setupGuestbookListener();
                    } else {
                        // Attempt to sign in if not already authenticated
                        try {
                            const token = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                            if (token) {
                                await signInWithCustomToken(auth, token);
                            } else {
                                await signInAnonymously(auth);
                            }
                        } catch (error) {
                            console.error("Authentication Error:", error);
                            displayAuthError();
                        }
                    }
                });
            } catch (error) {
                console.error("Firebase Initialization Error:", error);
                displayAuthError();
            }

            function displayAuthError() {
                const guestbookDisplay = document.getElementById('guestbookDisplay');
                const rsvpForm = document.getElementById('rsvpForm');
                guestbookDisplay.innerHTML = '<p class="text-red-500 text-center">Guestbook is currently unavailable. Please try reloading the page.</p>';
                document.getElementById('guestbookForm').style.display = 'none';
                rsvpForm.innerHTML = '<p class="text-red-500 text-center">RSVP feature is currently unavailable. Please try reloading the page.</p>';
            }

            // --- Guestbook Logic with Firestore ---
            const guestbookForm = document.getElementById('guestbookForm');
            const guestbookLoadingSpinner = document.getElementById('guestbookLoadingSpinner');
            const guestbookDisplay = document.getElementById('guestbookDisplay');
            const deleteModal = document.getElementById('deleteModal');
            const confirmDeleteBtn = document.getElementById('confirmDelete');
            const cancelDeleteBtn = document.getElementById('cancelDelete');
            let messageToDeleteId = null;
            
            function setupGuestbookListener() {
                const guestbookCollectionRef = collection(db, `/artifacts/${appId}/public/data/guestbook`);
                onSnapshot(guestbookCollectionRef, (snapshot) => {
                    guestbookDisplay.innerHTML = '';
                    const messages = [];
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        messages.push({ ...data, id: doc.id });
                    });

                    messages.sort((a, b) => b.timestamp?.seconds - a.timestamp?.seconds);

                    if (messages.length === 0) { 
                        guestbookDisplay.innerHTML = '<p class="text-gray-500">Be the first to leave a message!</p>'; 
                    } else {
                        messages.forEach(message => {
                            const messageEl = document.createElement('div');
                            messageEl.className = 'message relative';
                            let deleteButtonHtml = '';
                            if (message.userId === userId) {
                                deleteButtonHtml = `<button data-id="${message.id}" class="delete-btn absolute top-2 right-2 text-gray-400 hover:text-red-500 text-2xl leading-none">&times;</button>`;
                            }
                            messageEl.innerHTML = `<p class="font-semibold text-xl text-[#a87b6e]">${message.name || 'Anonymous'}</p><p class="text-gray-700 pr-6">${message.message || ''}</p><p class="text-xs text-gray-400 mt-2">${message.timestamp ? new Date(message.timestamp.seconds * 1000).toLocaleString() : 'Just now'}</p>${deleteButtonHtml}`;
                            guestbookDisplay.appendChild(messageEl);
                        });
                    }
                }, (error) => {
                    console.error("Error getting guestbook messages: ", error);
                    guestbookDisplay.innerHTML = '<p class="text-red-500">Could not load messages. Please try again later.</p>';
                });
            }

            guestbookDisplay.addEventListener('click', (e) => {
                if (e.target.classList.contains('delete-btn')) {
                    messageToDeleteId = e.target.dataset.id;
                    deleteModal.classList.remove('hidden');
                    deleteModal.classList.add('flex');
                }
            });
            
            cancelDeleteBtn.addEventListener('click', () => {
                deleteModal.classList.add('hidden');
                deleteModal.classList.remove('flex');
                messageToDeleteId = null;
            });

            confirmDeleteBtn.addEventListener('click', async () => {
                if (messageToDeleteId) {
                    try {
                        await deleteDoc(doc(db, `/artifacts/${appId}/public/data/guestbook`, messageToDeleteId));
                    } catch (error) {
                        console.error("Error removing document: ", error);
                    } finally {
                        cancelDeleteBtn.click();
                    }
                }
            });

            guestbookForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                guestbookLoadingSpinner.classList.remove('hidden');
                try {
                    await addDoc(collection(db, `/artifacts/${appId}/public/data/guestbook`), { name: document.getElementById('guestName').value, message: document.getElementById('guestMessage').value, timestamp: serverTimestamp(), userId: userId });
                    guestbookForm.reset();
                } catch (error) { console.error("Error adding document: ", error); } finally { guestbookLoadingSpinner.classList.add('hidden'); }
            });

            // --- RSVP Form Logic with Google Apps Script ---
            const rsvpForm = document.getElementById('rsvpForm');
            const rsvpMessage = document.getElementById('rsvpMessage');
            const rsvpLoadingSpinner = document.getElementById('rsvpLoadingSpinner');
            const rsvpSubmitBtn = document.getElementById('rsvpSubmitBtn');
            
            rsvpForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                rsvpLoadingSpinner.classList.remove('hidden');
                rsvpSubmitBtn.disabled = true;

                if (SCRIPT_URL === "YOUR_GOOGLE_APPS_SCRIPT_URL_HERE") {
                    rsvpMessage.textContent = "Please set up your Google Apps Script and paste the URL in the code.";
                    rsvpMessage.className = 'text-red-600 font-semibold mt-4';
                    rsvpLoadingSpinner.classList.add('hidden');
                    rsvpSubmitBtn.disabled = false;
                    return;
                }

                const formData = new FormData(rsvpForm);
                const rsvpData = Object.fromEntries(formData.entries());
                
                try {
                    const response = await fetch(SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors', // Required for Google Apps Script to work
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: new URLSearchParams(rsvpData)
                    });

                    // We can't check response.ok with no-cors, so we assume success
                    // The Apps Script will handle the sheet update.
                    rsvpMessage.textContent = "Thank you for your RSVP! We can't wait to see you.";
                    rsvpMessage.className = 'text-green-600 font-semibold mt-4';
                    rsvpForm.reset();
                } catch (error) {
                    console.error("Error submitting RSVP: ", error);
                    rsvpMessage.textContent = "Oops! Something went wrong. Please try again.";
                    rsvpMessage.className = 'text-red-600 font-semibold mt-4';
                } finally {
                    rsvpLoadingSpinner.classList.add('hidden');
                    rsvpSubmitBtn.disabled = false;
                }
            });

            const copyUserIdBtn = document.getElementById('copyUserIdBtn');
            copyUserIdBtn.addEventListener('click', () => {
                const tempInput = document.createElement('input');
                document.body.appendChild(tempInput);
                tempInput.value = userId;
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);
                copyUserIdBtn.textContent = 'Copied!';
                setTimeout(() => { copyUserIdBtn.textContent = `Copy Admin ID: ${userId}`; }, 2000);
            });

            // --- AI Dress Code Advisor with Gemini API ---
            const dressCodeBtn = document.getElementById('dressCodeBtn');
            const dressCodeQuery = document.getElementById('dressCodeQuery');
            const dressCodeResponse = document.getElementById('dressCodeResponse');
            const dressCodeSpinner = document.getElementById('dressCodeSpinner');
            
            async function generateResponseWithRetry(prompt) {
                const maxRetries = 3;
                const baseDelay = 1000; // 1 second
                let retries = 0;
                
                while (retries < maxRetries) {
                    try {
                        let chatHistory = [];
                        chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                        const payload = { contents: chatHistory };
                        const apiKey = "";
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                        
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            throw new Error(`API call failed with status: ${response.status}`);
                        }

                        const result = await response.json();
                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            return result.candidates[0].content.parts[0].text;
                        } else {
                            throw new Error('Unexpected API response structure.');
                        }
                    } catch (error) {
                        console.error(`Attempt ${retries + 1} failed: ${error.message}`);
                        retries++;
                        if (retries < maxRetries) {
                            const delay = baseDelay * Math.pow(2, retries);
                            await new Promise(res => setTimeout(res, delay));
                        } else {
                            return "I'm sorry, I'm having trouble with the request. Please try again later.";
                        }
                    }
                }
                return "I'm sorry, I'm having trouble with the request. Please try again later.";
            }

            dressCodeBtn.addEventListener('click', async () => {
                const query = dressCodeQuery.value;
                if (!query) {
                    dressCodeResponse.textContent = "Please enter a question.";
                    return;
                }
                
                dressCodeSpinner.classList.remove('hidden');
                dressCodeBtn.disabled = true;
                dressCodeResponse.textContent = 'Thinking...';
                
                const fullPrompt = `You are a helpful wedding dress code advisor for a wedding in Thiruvalla, Kerala. The dress code is "formal or festive wear". The guests are asking questions about what to wear. Your response should be friendly and helpful. Do not mention your name or model. Keep the response concise. Here is the guest's question: "${query}"`;
                
                const responseText = await generateResponseWithRetry(fullPrompt);
                
                dressCodeResponse.textContent = responseText;
                dressCodeSpinner.classList.add('hidden');
                dressCodeBtn.disabled = false;
            });
        });
    </script>
</body>
</html>
